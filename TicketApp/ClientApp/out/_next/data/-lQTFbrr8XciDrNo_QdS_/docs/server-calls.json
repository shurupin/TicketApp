{"pageProps":{"article":{"content":"\n# Server Calls\n\nThe application simulates all server calls using in memory data storage. This can be easily modified\nto connect to any server.\n\nYou can use any library you like. Most apps use [Axios](https://github.com/axios/axios) since it\nallows you to create instances, attach interceptors, and many other features. Another good\nalternative could be [Fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API).\n\n## Example of current implementation\n\n```jsx\nclass CustomerApi {\n  getCustomers() {\n    return Promise.resolve([\n      {\n        id: '238339KDC',\n        name: 'John'   \n      }\n    ]);\n  }\n};\n\nconst customerApi = new CustomerApi();\n\nconst Page = () => {\n  const [customers, setCustomers] = useState(null);\n\n  useEffect(() => {\n    const getCustomers = async () => {\n      const result = await customerApi.getCustomers();\n      setCustomers(result);\n    };\n\n    getCustomers();\n  }, []);\n\n  return (\n    <div>\n      {/* render content */}\n    </div>\n  );\n};\n```\n\nThe `customerApi` is a singleton class instance that simply responds with a Promise. You can add as\nmany requests methods as you need, test request structure or even use as middleware between UI and\nserver request to process your input and output data.\n\n## Example with Fetch\n\n```jsx\nconst Page = () => {\n  const [customers, setCustomers] = useState(null);\n\n  useEffect(() => {\n    const getCustomers = async () => {\n      const response = await fetch('/api/customers');\n      const data = await response.json();\n      setCustomers(data);\n    };\n\n    getCustomers();\n  }, []);\n\n  return (\n    <div>\n      {/* render content */}\n    </div>\n  );\n};\n```\n\n## Example with Axios\n\n```jsx\nimport axios from 'axios'; // You need to install it\n\nconst Page = () => {\n  const [customers, setCustomers] = useState(null);\n\n  useEffect(() => {\n    const getCustomers = async () => {\n      const response = await axios.get('/api/customers');\n      setCustomers(response.data);\n    };\n\n    getCustomers();\n  }, []);\n\n  return (\n    <div>\n      {/* render content */}\n    </div>\n  );\n};\n```\n\n## Axios Request interceptors\n\nBy using Axios you are able to\nintegrate [Axios Mock Adapter](https://github.com/ctimmerm/axios-mock-adapter) to simulate real\nserver calls. To archive that, you have to create an Axios instance and use it whenever you make a\nrequest call. Now you can extend your instance and add Axios Mock Adapter to listen for requests and\nreturn custom data.\n\n## Adding request interceptors\n\nIt takes ony a few seconds to add a new http request listener. The interceptor has a similar format\nto Express JS, for example:\n\n```js\nimport axios from 'axios';  // You need to install it\nimport AxiosMockAdapter from 'axios-mock-adapter';  // You need to install it\n\nexport const axiosInstance = axios.create();\n\naxiosInstance.interceptors.response.use(\n  (response) => response,\n  (error) => Promise.reject((error.response && error.response.data) || 'Something went wrong')\n);\n\nconst mock = new AxiosMockAdapter(axiosInstance, {delayResponse: 0});\n\nmock.onGet('/__fake-api__/invoices').reply(200, {\n  invoiceList: [\n    {id: 1, total: 32.43},\n    {id: 2, total: 67.00}\n  ]\n});\n```\n\nNow instead of importing axios from `axios` node module, import the exported `axiosInstance` to get\nthe customers' data.\n\n## Removing existing request interceptors\n\nThere are two ways:\n\n1. Simply use a new axios instance.\n2. Remove the mocked listeners.\n","slug":"server-calls","title":"Server Calls"}},"__N_SSG":true}